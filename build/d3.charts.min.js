(null===d3.charts||"object"!=typeof d3.charts)&&(d3.charts={}),this.d3.charts.barchart=function(){"use strict";function a(a){var f,g=function(){return"undefined"!=typeof f},h=(b-e.left-e.right,c-e.top-e.bottom),i=d3.scale.ordinal().rangeRoundBands([0,b],.3),j=d3.scale.ordinal(),k=d3.scale.linear().range([h,0]),l=d3.svg.axis().scale(i).orient("bottom"),m=d3.svg.axis().scale(k).orient("left");a.each(function(a){var n=d3.keys(a[0]).filter(function(a){return"xAxis"!==a&&"yAxis"!==a&&"target"!==a&&"group"!==a});d=d3.select(this).append("svg").attr("class","barchart").attr("width",b+e.left+e.right).attr("height",c+e.top+e.bottom);var o=d.append("g").attr("transform","translate("+e.left+","+e.top+")");a.forEach(function(a){a.group=n.map(function(b){return{name:b,value:+a[b].value,color:a[b].color}})}),i.domain(a.map(function(a){return a.xAxis})),j.domain(n).rangeRoundBands([0,i.rangeBand()]);var p=d3.min(a,function(a){return d3.min(a.group,function(a){return a.value})});p>0&&(p=0);var q=d3.max(a,function(a){return d3.max(a.group,function(a){return a.value})});"undefined"!=typeof a[0].target&&(f=Number(a[0].target)),g()&&f>q&&(q=f),k.domain([p,q]);var r=h;0>p&&q>0&&(r=h*(q/(q-p)));var s=o.selectAll(".cat").data(a).enter().append("g").attr("class","g").attr("transform",function(a){return"translate("+i(a.xAxis)+",0)"});s.selectAll("rect").data(function(a){return a.group}).enter().append("rect").attr("width",j.rangeBand()).attr("x",function(a){return j(a.name)}).attr("y",function(a){return a.value<0?k(0):k(a.value)}).attr("height",function(a){return a.value<0?k(a.value+q):h-k(a.value+p)}).style("fill",function(a){return a.color}),o.append("g").attr("class","x axis").attr("transform","translate(0,"+r+")").call(l),o.append("svg:g").attr("class","y axis").call(m).selectAll("g").append("svg:foreignObject").attr("width","150px").attr("height","40px").attr("x",-160).attr("y",-20).attr("style","text-align: right;").append("xhtml:div").html(function(a){return a}),o.selectAll(".y.axis g text").remove(),o.select(".y.axis").append("text").attr("y",-20).style("text-anchor","start").text(a[0].yAxis),g()&&o.append("line").attr("class","target").attr("x1",0).attr("y1",k(f)).attr("x2",b).attr("y2",k(f))})}var b=1200,c=400,d={},e={top:50,right:20,bottom:0,left:75};return a.width=function(c){return arguments.length?(b=c,a):b},a.height=function(b){return arguments.length?(c=b,a):c},a.svg=function(){return d},a},(null===d3.charts||"object"!=typeof d3.charts)&&(d3.charts={}),this.d3.charts.chartTitle=function(){"use strict";function a(a){a.each(function(){var f=a.append("g").attr("class","chart-title");f.attr("transform","translate("+b+","+c+")"),f.append("text").attr("x",0).attr("y",0).attr("dy",".35em").style("text-anchor","start").attr("class","header").text(d),f.append("text").attr("x",0).attr("y",15).attr("dy",".35em").style("text-anchor","start").text(e)})}var b=0,c=0,d="Lorem",e="Ipsum";return a.x=function(c){return arguments.length?(b=c,a):b},a.y=function(b){return arguments.length?(c=b,a):c},a.title=function(b){return arguments.length?(d=b,a):d},a.subTitle=function(b){return arguments.length?(e=b,a):e},a},(null===d3.charts||"object"!=typeof d3.charts)&&(d3.charts={}),this.d3.charts.donut=function(){"use strict";function a(a){b-e.left-e.right,c-e.top-e.bottom,a.each(function(a){var b=960,c=500,d=Math.min(b,c)/2,e=d3.scale.ordinal().range(["#98abc5","#8a89a6","#7b6888","#6b486b","#a05d56","#d0743c","#ff8c00"]),f=d3.svg.arc().outerRadius(d-10).innerRadius(d-70),g=d3.layout.pie().sort(null).value(function(a){return a.population}),h=d3.select("body").append("svg").attr("width",b).attr("height",c).append("g").attr("transform","translate("+b/2+","+c/2+")"),i=h.selectAll(".arc").data(g(a)).enter().append("g").attr("class","arc");i.append("path").attr("d",function(){}).style("fill",function(a){return e(a.data.age)}),i.append("text").attr("transform",function(a){return"translate("+f.centroid(a)+")"}).attr("dy",".35em").style("text-anchor","middle").text(function(a){return a.data.age})})}var b=960,c=500,d={},e={top:40,right:10,bottom:20,left:100};return a.width=function(c){return arguments.length?(b=c,a):b},a.height=function(b){return arguments.length?(c=b,a):c},a.svg=function(){return d},a},(null===d3.charts||"object"!=typeof d3.charts)&&(d3.charts={}),this.d3.charts.filter=function(){"use strict";function a(a){a.each(function(a){a.unshift("Select"),d=d3.select(this).append("div");var b=d.append("select"),c=b.selectAll("option").data(a);c.enter().append("option").attr("value",function(a){return a}).attr("subcategory",function(a){return a}).text(function(a){return a})})}var b=960,c=500,d={};return a.width=function(c){return arguments.length?(b=c,a):b},a.height=function(b){return arguments.length?(c=b,a):c},a.svg=function(){return d},a},(null===d3.charts||"object"!=typeof d3.charts)&&(d3.charts={}),this.d3.charts.groupStack=function(){"use strict";function a(a){var i=b-e.left-e.right-40,j=c-e.top-e.bottom-h.top,k=d3.format(".3s"),l=d3.charts.chartTitle().title(f).subTitle(g);a.each(function(a){var b=d3.layout.stack(),c=b(a),f=_.map(c[0],function(a){return a.x}),g=_.reduce(c,function(a,b){return a.push(b[0].category),a},[]),m=d3.max(c,function(a){return d3.max(a,function(a){return a.y0+a.y})}),n=d3.scale.ordinal().domain(f).rangeRoundBands([0,j],.2),o=d3.scale.linear().domain([0,m]).range([0,i]),p=d3.scale.ordinal().domain(g).range(d3.utilities.stackColors),q=d3.charts.legend().color(p);d=d3.select(this).append("svg").attr("class","groupStack").attr("width",i+e.left+e.right).attr("height",j+e.top+e.bottom+h.top),l.x(16).y(e.top),d.call(l);var r=d.append("g").attr("transform","translate("+e.left+","+(e.top+h.top)+")").attr("class","groupStack"),s=d3.svg.axis().scale(o).tickSize(-j).tickPadding(3).tickFormat(k).outerTickSize([0]).orient("bottom"),t=d3.svg.axis().scale(n).tickSize(0).orient("left");r.append("g").attr("class","y axis").call(t);var u=r.append("g").attr("class","x axis").attr("transform","translate(0,"+j+")").call(s);u.selectAll("g").classed("gridline",!0),u.selectAll("text").attr("x",18);var v=r.selectAll(".layer").data(c).enter().append("g").attr("class","layer").style("fill",function(a,b){return p(b)}),w=v.selectAll("rect").data(function(a){return a}).enter().append("rect").attr("x",0).attr("y",function(a){return n(a.x)}).attr("width",0).attr("height",n.rangeBand());w.transition().delay(function(a,b){return 40*b}).attr("x",function(a){return o(a.y0)}).attr("width",function(a){return o(a.y)}),v.selectAll("text").data(_.last(c)).enter().append("text").attr("x",function(a){return o(a.y+a.y0)+5}).attr("y",function(a){return n(a.y)+n.rangeBand()/2+4}).attr("class","value").text(function(a){return k(a.y+a.y0)}),q.y(h.top).x(i+30+e.right),d.datum(g).call(q)})}var b=1024,c=500,d={},e={top:10,right:184,bottom:20,left:168},f="STACKED BAR CHART EXAMPLE",g="Subtext as needed",h={top:30};return a.width=function(c){return arguments.length?(b=c,a):b},a.height=function(b){return arguments.length?(c=b,a):c},a.svg=function(){return d},a.title=function(b){return arguments.length?(f=b,a):f},a.subtitle=function(b){return arguments.length?(g=b,a):g},a},(null===d3.charts||"object"!=typeof d3.charts)&&(d3.charts={}),this.d3.charts.heatmap=function(){"use strict";function a(a){var g=b-f.left-f.right,l=c-k()-f.bottom,m=d3.scale.ordinal().rangeRoundBands([0,g]),n=d3.scale.ordinal().rangeRoundBands([0,g]),o=d3.scale.ordinal().rangeRoundBands([0,l]),p=d3.charts.chartTitle().title(i).subTitle(j),q={},r={},s={},t={},u={},v={},w=function(a){m.domain(d3.utilities.uniqueProperties(a,"xAxis")),o.domain(d3.utilities.uniqueProperties(a,"yAxis"));var b=r.selectAll("g.heatmap .square").data(a);b.enter().append("rect").attr("class","square").attr("style",function(a){return"fill:"+a.color}),b.attr("x",function(a){return m(a.xAxis)}).attr("y",function(a){return o(a.yAxis)}).attr("rx",0).attr("ry",0).attr("width",m.rangeBand()).attr("height",o.rangeBand()).transition().style("fill",function(a){return a.color}),b.exit().remove();var c=r.selectAll("g.heatmap .cell.value").data(a);c.enter().append("text"),c.attr("text-anchor","middle").attr("x",function(a){return m(a.xAxis)}).attr("y",function(a){return o(a.yAxis)}).attr("dy",function(){return o.rangeBand()/2+4}).attr("dx",function(){return m.rangeBand()/2}).attr("class","cell value").text(function(a){return a.value}),c.exit().remove(),z()},x=function(a){u=e.append("g").attr("class","controls").attr("transform","translate("+f.left+","+(k()-h.top-d)+")"),u.append("rect").attr("class","border").attr("x",0).attr("y",0).attr("rx",4).attr("ry",4).attr("width",g).attr("height",d);var b=u.selectAll(".text").data(a);b.enter().append("svg:foreignObject").attr("class","text").attr("category",function(a){return a}).append("xhtml:div").html(function(a){return a}),b.attr("x",function(a){return n(a)}).attr("y",0).attr("width",n.rangeBand()).attr("height",d).attr("style","line-height:"+d+"px").on("click",q)},y=function(a){var b=t.selectAll("category").data([a]);b.enter().append("category"),b.text(function(a){return a})},z=function(){var a=s.selectAll("g.top-nav .text").data(m.domain());a.enter().append("svg:foreignObject").attr("class","text").append("xhtml:div").html(function(a){return a}),a.attr("width",m.rangeBand()).attr("height",h.top).attr("x",function(a){return m(a)}).attr("y",function(){return o(o.domain()[0])}).attr("style","line-height:"+h.top+"px"),a.exit().remove();var b=v.selectAll("g.left-nav .text").data(o.domain());b.enter().append("svg:foreignObject").attr("class","text").append("xhtml:div").html(function(a){return a}),b.attr("width",f.left).attr("height",o.rangeBand()).attr("x",function(){return m(m.domain()[0])}).attr("y",function(a){return o(a)}).attr("style","line-height:"+o.rangeBand()+"px"),b.exit().remove()};a.each(function(a){var b=d3.utilities.uniqueProperties(a,"name");n.domain(b),q=function(b){u.selectAll("div").attr("class","unselected"),u.select('[category="'+b+'"] div').attr("class","selected");var c=_.find(a,function(a){return a.name==b}).data;w(c),y(b)},e=d3.select(this).append("svg").attr("class","heatmap").attr("width",g+f.left+f.right).attr("height",l+k()+f.bottom),p.x(16).y(f.top),e.call(p),r=e.append("g").attr("class","heatmap").attr("transform","translate("+f.left+","+k()+")"),s=e.append("g").attr("class","top-nav").attr("transform","translate("+f.left+","+(k()-h.top)+")"),v=e.append("g").attr("class","left-nav").attr("transform","translate(0,"+k()+")"),t=e.append("meta-data"),b.length>1?(x(b),w(a[0].data)):w(a[0].data)})}var b=1024,c=500,d=50,e={},f={top:10,right:184,bottom:20,left:168},g={top:30},h={top:20},i="HEATMAP CHART EXAMPLE",j="Subtext as needed",k=function(){var a=!0,b=f.top+g.top+h.top;return b+=a?d:0};return a.width=function(c){return arguments.length?(b=c,a):b},a.height=function(b){return arguments.length?(c=b,a):c},a.svg=function(){return e},a.title=function(b){return arguments.length?(i=b,a):i},a.subtitle=function(b){return arguments.length?(j=b,a):j},a},(null===d3.charts||"object"!=typeof d3.charts)&&(d3.charts={}),this.d3.charts.legend=function(){"use strict";function a(a){a.each(function(f){var g=a.append("g").attr("class","legend-container").attr("transform","translate("+b+","+c+")"),h=g.selectAll(".legend").data(f).enter().append("g").attr("class","legend");h.append("rect").attr("x",0).attr("y",function(a,b){return 25*b+c}).attr("width",14).attr("height",14).style("fill",function(a){return d(a)}),e&&g.selectAll("rect").attr("style","text-decoration: underline;cursor: pointer;").on("click",e).style("fill",function(a){return d(a)}),h.append("text").attr("x",20).attr("y",function(a,b){return 25*b+c+7}).attr("dy",".35em").style("text-anchor","start").text(function(a){return a})})}var b=0,c=0,d=d3.scale.category10(),e=void 0;return a.x=function(c){return arguments.length?(b=c,a):b},a.y=function(b){return arguments.length?(c=b,a):c},a.color=function(b){return arguments.length?(d=b,a):d},a.click=function(b){return arguments.length?(e=b,a):e},a},(null===d3.charts||"object"!=typeof d3.charts)&&(d3.charts={}),this.d3.charts.timeseries=function(){"use strict";function a(a){var l,m=function(){return"undefined"!=typeof l},n=b-e.left-e.right,o=c-(e.top+f.top)-e.bottom,p=d,q=d3.time.scale().range([0,n]),r=d3.time.scale().range([0,n]),s=d3.scale.linear().range([o,0]),t=d3.scale.linear().range([p,0]),u=d3.svg.axis().scale(q).orient("top").tickFormat(d3.utilities.customTimeFormat).outerTickSize([0]).ticks(8),v=d3.svg.axis().scale(r).orient("bottom").tickFormat(d3.utilities.customTimeFormat).outerTickSize([0]).ticks(12),w=d3.svg.axis().scale(s).orient("right").ticks(10),x=d3.charts.chartTitle().title(i).subTitle(j);a.each(function(a){var b=d3.min(a,function(a){return d3.min(a.data,function(a){return a.value})}),c=d3.max(a,function(a){return d3.max(a.data,function(a){return a.value})}),d=d3.utilities.padDomain(s.range()[0],c,0),i=d3.utilities.padDomain(s.range()[0],c,60),j=_.reduce(a,function(a,b){return a.push(b.series),a},[]),y=d3.scale.ordinal().domain(j).range(d3.utilities.colorWheel),z=d3.charts.legend().color(y);b-=i,c+=d,q.domain(d3.extent(a[0].data,function(a){return a.date})),s.domain([b,c+d+i]),r.domain(q.domain()),t.domain(s.domain());var A=d3.svg.line().interpolate("cardinal").x(function(a){return q(a.date)}).y(function(a){return s(a.value)}),B=d3.svg.line().interpolate("cardinal").x(function(a){return r(a.date)}).y(function(a){return t(a.value)});h=d3.select(this).append("svg").attr("class","timeseries").attr("width",n+e.left+e.right).attr("height",o+(e.top+f.top)+e.bottom),x.x(e.left).y(e.top),h.call(x),h.append("defs").append("clipPath").attr("id","clip").append("rect").attr("width",n).attr("height",o);var C=h.append("g").attr("class","chart1").attr("transform","translate("+e.left+","+(e.top+f.top)+")");C.append("g").attr("class","x axis").attr("transform","translate(0,"+s(b)+")").call(u),w.tickSize(n);var D=C.append("svg:g").attr("class","y axis").call(w);if(D.selectAll("g").classed("gridline",!0),D.selectAll("text").attr("x",4).attr("dy",-4),0>b){var E=s(0),F=s(b);C.append("rect").attr("class","zeroline").attr("x",0).attr("y",E).attr("height",F-E).attr("width",n)}"undefined"!=typeof a[0].data[0].target&&(l=Number(a[0].data[0].target)),m()&&C.append("line").attr("class","target").attr("x1",0).attr("y1",s(l)).attr("x2",n).attr("y2",s(l));var G=C.append("g").attr("class","chart");G.selectAll("path").data(a).enter().append("path").attr("clip-path","url(#clip)").attr("class","line").style("stroke",function(a){return y(a.series)}).style("stroke-width","2px").attr("series",function(a){return a.series}).attr("d",function(a){return A(a.data)}),k&&G.selectAll("circle").data(_.flatten(a,"data")).enter().append("circle").attr("class","circle").attr("clip-path","url(#clip)").style("stroke",function(a){return a.color}).attr("cx",function(a){return q(a.date)}).attr("cy",function(a){return s(a.value)}).attr("r",g);var H=h.append("g").attr("class","chart2").attr("transform","translate("+e.left+","+(o+e.top+f.top)+")"),I=function(){q.domain(J.empty()?r.domain():J.extent()),_.filter(a[0].data,function(a){return a.date>=q.domain()[0]&&a.date<=q.domain()[1]}),C.selectAll("g.chart path").data(a).attr("d",function(a){return A(a.data)}),C.selectAll("circle").data(_.flatten(a,"data")).attr("cx",function(a){return q(a.date)}).attr("cy",function(a){return s(a.value)}),C.select(".x.axis").call(u)},J=d3.svg.brush().x(r).on("brush",I);H.selectAll("path").data(a).enter().append("path").attr("class","minor line").style("stroke-width","1px").attr("d",function(a){return B(a.data)}),H.append("g").attr("class","x axis").attr("transform","translate(0,"+p+")").call(v),r.domain()[0],new Date,J.extent([r.domain()[0],r.domain()[1]]);var K=H.append("g").attr("class","x brush").call(J);K.selectAll("rect").attr("height",p),K.selectAll(".resize").append("path").attr("d",function(a){return d3.utilities.resizeHandles(a,p)});var L=function(a){var b='g.chart1 [series="'+a+'"]',c=C.select(b),d="2px"==c.style("stroke-width")?"10px":"2px";c.transition().style("stroke-width",d)};z.click(L).y(f.top).x(n+30),h.datum(j).call(z)})}var b=1024,c=500,d=50,e={top:10,right:168,bottom:70,left:16},f={top:30},g=4,h={},i="TIME SERIES CHART EXAMPLE",j="Subtext as needed",k=!1;return a.width=function(c){return arguments.length?(b=c,a):b},a.height=function(b){return arguments.length?(c=b,a):c},a.title=function(b){return arguments.length?(i=b,a):i},a.subtitle=function(b){return arguments.length?(j=b,a):j},a.svg=function(){return h},a.dataPoints=function(b){return arguments.length?(k=b,a):k},a},(null===d3.utilities||"object"!=typeof d3.utilities)&&(d3.utilities={}),this.d3.helpers={timeFormat:function(a){return function(b){for(var c=a.length-1,d=a[c];!d[1](b);)d=a[--c];return d[0](b)}}},this.d3.utilities={uniqueProperties:function(a,b){return _.reduce(a,function(a,c){return a.filter(function(a){return c[b]===a}).length||a.push(c[b]),a},[])},colorWheel:["#F3504F","#F28A00","#F1C40E","#57D68D","#15A085","#00237E","#3398DB","#74DDE8","#9B59B6","#661C79"],stackColors:["#85C1E9","#00227D"],customTimeFormat:d3.helpers.timeFormat([[d3.time.format("%Y"),function(){return!0}],[d3.time.format("%b"),function(a){return a.getMonth()}],[d3.time.format("%b %d"),function(a){return 1!=a.getDate()}],[d3.time.format("%a %d"),function(a){return a.getDay()&&1!=a.getDate()}],[d3.time.format("%I %p"),function(a){return a.getHours()}],[d3.time.format("%I:%M"),function(a){return a.getMinutes()}],[d3.time.format(":%S"),function(a){return a.getSeconds()}],[d3.time.format(".%L"),function(a){return a.getMilliseconds()}]]),padDomain:function(a,b,c){return c/a*b},resizeHandles:function(a,b){var c=+("e"==a),d=c?1:-1,e=b/3;return"M"+.5*d+","+e+"A6,6 0 0 "+c+" "+6.5*d+","+(e+6)+"V"+(2*e-6)+"A6,6 0 0 "+c+" "+.5*d+","+2*e+"Z"+"M"+2.5*d+","+(e+6)+"V"+(2*e-6)+"M"+4.5*d+","+(e+6)+"V"+(2*e-6)},comma:d3.format(",")};